---
output-file: exogenous_variables.html
title: Exogenous variables
---


Exogenous variables or external factors are crucial in time series
forecasting as they provide additional information that might influence
the prediction. These variables could include holiday markers, marketing
spending, weather data, or any other external data that correlate with
the time series data you are forecasting.

For example, if you’re forecasting ice cream sales, temperature data
could serve as a useful exogenous variable. On hotter days, ice cream
sales may increase.

To incorporate exogenous variables in TimeGPT, you’ll need to pair each
point in your time series data with the corresponding external data.

[![](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/Nixtla/nixtla/blob/main/nbs/docs/tutorials/1_exogenous_variables.ipynb)

```python
import pandas as pd
from nixtlats import TimeGPT
```

``` text
/home/ubuntu/miniconda/envs/nixtlats/lib/python3.11/site-packages/statsforecast/core.py:25: TqdmWarning: IProgress not found. Please update jupyter and ipywidgets. See https://ipywidgets.readthedocs.io/en/stable/user_install.html
  from tqdm.autonotebook import tqdm
```

```python
timegpt = TimeGPT(
    # defaults to os.environ.get("TIMEGPT_TOKEN")
    token = 'my_token_provided_by_nixtla'
)
```

Let’s see an example on predicting day-ahead electricity prices. The
following dataset contains the hourly electricity price (`y` column) for
five markets in Europe and US, identified by the `unique_id` column. The
columns from `Exogenous1` to `day_6` are exogenous variables that
TimeGPT will use to predict the prices.

```python
df = pd.read_csv('https://raw.githubusercontent.com/Nixtla/transfer-learning-time-series/main/datasets/electricity-short-with-ex-vars.csv')
df.head()
```

|     | unique_id | ds                  | y     | Exogenous1 | Exogenous2 | day_0 | day_1 | day_2 | day_3 | day_4 | day_5 | day_6 |
|-----|-----------|---------------------|-------|------------|------------|-------|-------|-------|-------|-------|-------|-------|
| 0   | BE        | 2016-12-01 00:00:00 | 72.00 | 61507.0    | 71066.0    | 0.0   | 0.0   | 0.0   | 1.0   | 0.0   | 0.0   | 0.0   |
| 1   | BE        | 2016-12-01 01:00:00 | 65.80 | 59528.0    | 67311.0    | 0.0   | 0.0   | 0.0   | 1.0   | 0.0   | 0.0   | 0.0   |
| 2   | BE        | 2016-12-01 02:00:00 | 59.99 | 58812.0    | 67470.0    | 0.0   | 0.0   | 0.0   | 1.0   | 0.0   | 0.0   | 0.0   |
| 3   | BE        | 2016-12-01 03:00:00 | 50.69 | 57676.0    | 64529.0    | 0.0   | 0.0   | 0.0   | 1.0   | 0.0   | 0.0   | 0.0   |
| 4   | BE        | 2016-12-01 04:00:00 | 52.58 | 56804.0    | 62773.0    | 0.0   | 0.0   | 0.0   | 1.0   | 0.0   | 0.0   | 0.0   |

To produce forecasts we also have to add the future values of the
exogenous variables. Let’s read this dataset. In this case, we want to
predict 24 steps ahead, therefore each `unique_id` will have 24
observations.

```python
future_ex_vars_df = pd.read_csv('https://raw.githubusercontent.com/Nixtla/transfer-learning-time-series/main/datasets/electricity-short-future-ex-vars.csv')
future_ex_vars_df.head()
```

|     | unique_id | ds                  | Exogenous1 | Exogenous2 | day_0 | day_1 | day_2 | day_3 | day_4 | day_5 | day_6 |
|-----|-----------|---------------------|------------|------------|-------|-------|-------|-------|-------|-------|-------|
| 0   | BE        | 2016-12-31 00:00:00 | 64108.0    | 70318.0    | 0.0   | 0.0   | 0.0   | 0.0   | 0.0   | 1.0   | 0.0   |
| 1   | BE        | 2016-12-31 01:00:00 | 62492.0    | 67898.0    | 0.0   | 0.0   | 0.0   | 0.0   | 0.0   | 1.0   | 0.0   |
| 2   | BE        | 2016-12-31 02:00:00 | 61571.0    | 68379.0    | 0.0   | 0.0   | 0.0   | 0.0   | 0.0   | 1.0   | 0.0   |
| 3   | BE        | 2016-12-31 03:00:00 | 60381.0    | 64972.0    | 0.0   | 0.0   | 0.0   | 0.0   | 0.0   | 1.0   | 0.0   |
| 4   | BE        | 2016-12-31 04:00:00 | 60298.0    | 62900.0    | 0.0   | 0.0   | 0.0   | 0.0   | 0.0   | 1.0   | 0.0   |

Let’s call the `forecast` method, adding this information:

```python
timegpt_fcst_ex_vars_df = timegpt.forecast(df=df, X_df=future_ex_vars_df, h=24, level=[80, 90])
timegpt_fcst_ex_vars_df.head()
```

``` text
INFO:nixtlats.timegpt:Validating inputs...
INFO:nixtlats.timegpt:Preprocessing dataframes...
INFO:nixtlats.timegpt:Inferred freq: H
INFO:nixtlats.timegpt:Calling Forecast Endpoint...
```

|     | unique_id | ds                  | TimeGPT   | TimeGPT-lo-90 | TimeGPT-lo-80 | TimeGPT-hi-80 | TimeGPT-hi-90 |
|-----|-----------|---------------------|-----------|---------------|---------------|---------------|---------------|
| 0   | BE        | 2016-12-31 00:00:00 | 38.861762 | 33.821073     | 34.368669     | 43.354854     | 43.902450     |
| 1   | BE        | 2016-12-31 01:00:00 | 35.382102 | 30.014594     | 31.493322     | 39.270882     | 40.749610     |
| 2   | BE        | 2016-12-31 02:00:00 | 33.811425 | 26.658821     | 28.543087     | 39.079764     | 40.964029     |
| 3   | BE        | 2016-12-31 03:00:00 | 31.707475 | 24.896205     | 26.818795     | 36.596155     | 38.518745     |
| 4   | BE        | 2016-12-31 04:00:00 | 30.316475 | 21.125143     | 24.432148     | 36.200801     | 39.507807     |

```python
timegpt.plot(
    df[['unique_id', 'ds', 'y']], 
    timegpt_fcst_ex_vars_df, 
    max_insample_length=365, 
    level=[80, 90], 
)
```

![](/nixtla/docs/tutorials/1_exogenous_variables_files/figure-markdown_strict/cell-8-output-1.png)

We also can get the importance of the features.

```python
timegpt.weights_x.plot.barh(x='features', y='weights')
```

![](/nixtla/docs/tutorials/1_exogenous_variables_files/figure-markdown_strict/cell-9-output-1.png)

You can also add country holidays using the `CountryHolidays` class.

```python
from nixtlats.date_features import CountryHolidays
```


```python
timegpt_fcst_ex_vars_df = timegpt.forecast(
    df=df, X_df=future_ex_vars_df, h=24, level=[80, 90], 
    date_features=[CountryHolidays(['US'])]
)
timegpt.weights_x.plot.barh(x='features', y='weights')
```

``` text
INFO:nixtlats.timegpt:Validating inputs...
INFO:nixtlats.timegpt:Preprocessing dataframes...
INFO:nixtlats.timegpt:Inferred freq: H
INFO:nixtlats.timegpt:Calling Forecast Endpoint...
```

![](/nixtla/docs/tutorials/1_exogenous_variables_files/figure-markdown_strict/cell-11-output-2.png)

