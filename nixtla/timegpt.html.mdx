---
output-file: timegpt.html
title: TimeGPT

---

------------------------------------------------------------------------

### TimeGPT

> ``` text
>  TimeGPT (token:Optional[str]=None, environment:Optional[str]=None,
>           max_retries:int=6, retry_interval:int=10, max_wait_time:int=360)
> ```

Constructs all the necessary attributes for the TimeGPT object.

|                | **Type** | **Default** | **Details**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|------|------------------|-------------------------|-------------------------|
| token          | Optional | None        | The authorization token interacts with the TimeGPT API.<br/>If not provided, it will be inferred by the TIMEGPT_TOKEN environment variable.                                                                                                                                                                                                                                                                                                                                                                                                                    |
| environment    | Optional | None        | Custom environment. Pass only if provided.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| max_retries    | int      | 6           | The maximum number of attempts to make when calling the API before giving up. <br/>It defines how many times the client will retry the API call if it fails. <br/>Default value is 6, indicating the client will attempt the API call up to 6 times in total                                                                                                                                                                                                                                                                                                    |
| retry_interval | int      | 10          | The interval in seconds between consecutive retry attempts. <br/>This is the waiting period before the client tries to call the API again after a failed attempt. <br/>Default value is 10 seconds, meaning the client waits for 10 seconds between retries.                                                                                                                                                                                                                                                                                                    |
| max_wait_time  | int      | 360         | The maximum total time in seconds that the client will spend on all retry attempts before giving up. <br/>This sets an upper limit on the cumulative waiting time for all retry attempts. <br/>If this time is exceeded, the client will stop retrying and raise an exception. <br/>Default value is 360 seconds, meaning the client will cease retrying if the total time <br/>spent on retries exceeds 360 seconds. <br/>The client throws a ReadTimeout error after 60 seconds of inactivity. If you want to <br/>catch these errors, use max_wait_time \>\> 60. |

------------------------------------------------------------------------

## TimeGPT.validate_token

> ``` text
>  TimeGPT.validate_token (log:bool=True)
> ```

Returns True if your token is valid.

Now you can start to make forecasts! Let’s import an example:

------------------------------------------------------------------------

## TimeGPT.plot

> ``` text
>  TimeGPT.plot (df:pandas.core.frame.DataFrame,
>                forecasts_df:Optional[pandas.core.frame.DataFrame]=None,
>                id_col:str='unique_id', time_col:str='ds',
>                target_col:str='y',
>                unique_ids:Union[List[str],NoneType,numpy.ndarray]=None,
>                plot_random:bool=True, models:Optional[List[str]]=None,
>                level:Optional[List[float]]=None,
>                max_insample_length:Optional[int]=None,
>                plot_anomalies:bool=False, engine:str='matplotlib',
>                resampler_kwargs:Optional[Dict]=None)
> ```

Plot forecasts and insample values.

|                     | **Type**  | **Default** | **Details**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|------|------------------|-------------------------|-------------------------|
| df                  | DataFrame |             | The DataFrame on which the function will operate. Expected to contain at least the following columns:<br/>- time_col:<br/> Column name in `df` that contains the time indices of the time series. This is typically a datetime<br/> column with regular intervals, e.g., hourly, daily, monthly data points.<br/>- target_col:<br/> Column name in `df` that contains the target variable of the time series, i.e., the variable we <br/> wish to predict or analyze.<br/>Additionally, you can pass multiple time series (stacked in the dataframe) considering an additional column:<br/>- id_col:<br/> Column name in `df` that identifies unique time series. Each unique value in this column<br/> corresponds to a unique time series. |
| forecasts_df        | Optional  | None        | DataFrame with columns \[`unique_id`, `ds`\] and models.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| id_col              | str       | unique_id   | Column that identifies each serie.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| time_col            | str       | ds          | Column that identifies each timestep, its values can be timestamps or integers.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| target_col          | str       | y           | Column that contains the target.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| unique_ids          | Union     | None        | Time Series to plot.<br/>If None, time series are selected randomly.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| plot_random         | bool      | True        | Select time series to plot randomly.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| models              | Optional  | None        | List of models to plot.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| level               | Optional  | None        | List of prediction intervals to plot if paseed.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| max_insample_length | Optional  | None        | Max number of train/insample observations to be plotted.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| plot_anomalies      | bool      | False       | Plot anomalies for each prediction interval.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| engine              | str       | matplotlib  | Library used to plot. ‘plotly’, ‘plotly-resampler’ or ‘matplotlib’.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| resampler_kwargs    | Optional  | None        | Kwargs to be passed to plotly-resampler constructor.<br/>For further custumization (“show_dash”) call the method,<br/>store the plotting object and add the extra arguments to<br/>its `show_dash` method.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |

------------------------------------------------------------------------

## TimeGPT.forecast

> ``` text
>  TimeGPT.forecast (df:pandas.core.frame.DataFrame, h:int,
>                    freq:Optional[str]=None, id_col:str='unique_id',
>                    time_col:str='ds', target_col:str='y',
>                    X_df:Optional[pandas.core.frame.DataFrame]=None,
>                    level:Optional[List[Union[int,float]]]=None,
>                    finetune_steps:int=0, clean_ex_first:bool=True,
>                    validate_token:bool=False, add_history:bool=False,
>                    date_features:Union[bool,List[str]]=False,
>                    date_features_to_one_hot:Union[bool,List[str]]=True,
>                    model:str='timegpt-1',
>                    num_partitions:Optional[int]=None)
> ```

Forecast your time series using TimeGPT.

|                          | **Type**             | **Default** | **Details**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|------|------------------|-------------------------|-------------------------|
| df                       | DataFrame            |             | The DataFrame on which the function will operate. Expected to contain at least the following columns:<br/>- time_col:<br/> Column name in `df` that contains the time indices of the time series. This is typically a datetime<br/> column with regular intervals, e.g., hourly, daily, monthly data points.<br/>- target_col:<br/> Column name in `df` that contains the target variable of the time series, i.e., the variable we <br/> wish to predict or analyze.<br/>Additionally, you can pass multiple time series (stacked in the dataframe) considering an additional column:<br/>- id_col:<br/> Column name in `df` that identifies unique time series. Each unique value in this column<br/> corresponds to a unique time series. |
| h                        | int                  |             | Forecast horizon.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| freq                     | Optional             | None        | Frequency of the data. By default, the freq will be inferred automatically.<br/>See [pandas’ available frequencies](https://pandas.pydata.org/pandas-docs/stable/user_guide/timeseries.html#offset-aliases).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| id_col                   | str                  | unique_id   | Column that identifies each serie.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| time_col                 | str                  | ds          | Column that identifies each timestep, its values can be timestamps or integers.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| target_col               | str                  | y           | Column that contains the target.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| X_df                     | Optional             | None        | DataFrame with \[`unique_id`, `ds`\] columns and `df`’s future exogenous.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| level                    | Optional             | None        | Confidence levels between 0 and 100 for prediction intervals.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| finetune_steps           | int                  | 0           | Number of steps used to finetune TimeGPT in the<br/>new data.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| clean_ex_first           | bool                 | True        | Clean exogenous signal before making forecasts<br/>using TimeGPT.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| validate_token           | bool                 | False       | If True, validates token before <br/>sending requests.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| add_history              | bool                 | False       | Return fitted values of the model.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| date_features            | Union                | False       | Features computed from the dates. <br/>Can be pandas date attributes or functions that will take the dates as input.<br/>If True automatically adds most used date features for the <br/>frequency of `df`.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| date_features_to_one_hot | Union                | True        | Apply one-hot encoding to these date features.<br/>If `date_features=True`, then all date features are<br/>one-hot encoded by default.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| model                    | str                  | timegpt-1   | Model to use as a string. Options are: `timegpt-1`, and `timegpt-1-long-horizon`. <br/>We recommend using `timegpt-1-long-horizon` for forecasting <br/>if you want to predict more than one seasonal <br/>period given the frequency of your data.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| num_partitions           | Optional             | None        | Number of partitions to use.<br/>If None, the number of partitions will be equal<br/>to the available parallel resources in distributed environments.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| **Returns**              | **pandas.DataFrame** |             | **DataFrame with TimeGPT forecasts for point predictions and probabilistic<br/>predictions (if level is not None).**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |

------------------------------------------------------------------------

## TimeGPT.cross_validation

> ``` text
>  TimeGPT.cross_validation (df:pandas.core.frame.DataFrame, h:int,
>                            freq:Optional[str]=None,
>                            id_col:str='unique_id', time_col:str='ds',
>                            target_col:str='y',
>                            level:Optional[List[Union[int,float]]]=None,
>                            validate_token:bool=False, n_windows:int=1,
>                            step_size:Optional[int]=None,
>                            finetune_steps:int=0, clean_ex_first:bool=True,
>                            date_features:Union[bool,List[str]]=False, date
>                            _features_to_one_hot:Union[bool,List[str]]=True
>                            , model:str='timegpt-1',
>                            num_partitions:Optional[int]=None)
> ```

Perform cross validation in your time series using TimeGPT.

|                          | **Type**             | **Default** | **Details**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|------|------------------|-------------------------|-------------------------|
| df                       | DataFrame            |             | The DataFrame on which the function will operate. Expected to contain at least the following columns:<br/>- time_col:<br/> Column name in `df` that contains the time indices of the time series. This is typically a datetime<br/> column with regular intervals, e.g., hourly, daily, monthly data points.<br/>- target_col:<br/> Column name in `df` that contains the target variable of the time series, i.e., the variable we<br/> wish to predict or analyze.<br/>Additionally, you can pass multiple time series (stacked in the dataframe) considering an additional column:<br/>- id_col:<br/> Column name in `df` that identifies unique time series. Each unique value in this column<br/> corresponds to a unique time series. |
| h                        | int                  |             | Forecast horizon.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| freq                     | Optional             | None        | Frequency of the data. By default, the freq will be inferred automatically.<br/>See [pandas’ available frequencies](https://pandas.pydata.org/pandas-docs/stable/user_guide/timeseries.html#offset-aliases).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| id_col                   | str                  | unique_id   | Column that identifies each serie.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| time_col                 | str                  | ds          | Column that identifies each timestep, its values can be timestamps or integers.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| target_col               | str                  | y           | Column that contains the target.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| level                    | Optional             | None        | Confidence level between 0 and 100 for detecting the anomalies.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| validate_token           | bool                 | False       | If True, validates token before<br/>sending requests.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| n_windows                | int                  | 1           | Number of windows to evaluate.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| step_size                | Optional             | None        | Step size between each cross validation window. If None it will be equal to `h`.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| finetune_steps           | int                  | 0           | Number of steps used to finetune TimeGPT in the<br/>new data.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| clean_ex_first           | bool                 | True        | Clean exogenous signal before making forecasts<br/>using TimeGPT.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| date_features            | Union                | False       | Features computed from the dates.<br/>Can be pandas date attributes or functions that will take the dates as input.<br/>If True automatically adds most used date features for the<br/>frequency of `df`.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| date_features_to_one_hot | Union                | True        | Apply one-hot encoding to these date features.<br/>If `date_features=True`, then all date features are<br/>one-hot encoded by default.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| model                    | str                  | timegpt-1   | Model to use as a string. Options are: `timegpt-1`, and `timegpt-1-long-horizon`. <br/>We recommend using `timegpt-1-long-horizon` for forecasting <br/>if you want to predict more than one seasonal <br/>period given the frequency of your data.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| num_partitions           | Optional             | None        | Number of partitions to use.<br/>If None, the number of partitions will be equal<br/>to the available parallel resources in distributed environments.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| **Returns**              | **pandas.DataFrame** |             | **DataFrame with cross validation forecasts.**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |

```python
# test pass dataframe with index
df_ds_index = df_.set_index('ds')[['unique_id', 'y']]
df_ds_index.index = pd.DatetimeIndex(df_ds_index.index)
fcst_inferred_df_index = timegpt.forecast(df_ds_index, h=10)
anom_inferred_df_index = timegpt.detect_anomalies(df_ds_index)
fcst_inferred_df = timegpt.forecast(df_[['ds', 'unique_id', 'y']], h=10)
anom_inferred_df = timegpt.detect_anomalies(df_[['ds', 'unique_id', 'y']])
pd.testing.assert_frame_equal(fcst_inferred_df_index, fcst_inferred_df, atol=1e-3)
pd.testing.assert_frame_equal(anom_inferred_df_index, anom_inferred_df, atol=1e-3)
df_ds_index = df_ds_index.groupby('unique_id').tail(80)
for freq in ['Y', 'W-MON', 'Q-DEC', 'H']:
    df_ds_index.index = np.concatenate(
        df_ds_index['unique_id'].nunique() * [pd.date_range(end='2023-01-01', periods=80, freq=freq)]
    )
    df_ds_index.index.name = 'ds'
    fcst_inferred_df_index = timegpt.forecast(df_ds_index, h=10)
    df_test = df_ds_index.reset_index()
    fcst_inferred_df = timegpt.forecast(df_test, h=10)
    pd.testing.assert_frame_equal(fcst_inferred_df_index, fcst_inferred_df, atol=1e-3)
```

------------------------------------------------------------------------

## TimeGPT.detect_anomalies

> ``` text
>  TimeGPT.detect_anomalies (df:pandas.core.frame.DataFrame,
>                            freq:Optional[str]=None,
>                            id_col:str='unique_id', time_col:str='ds',
>                            target_col:str='y', level:Union[int,float]=99,
>                            clean_ex_first:bool=True,
>                            validate_token:bool=False,
>                            date_features:Union[bool,List[str]]=False, date
>                            _features_to_one_hot:Union[bool,List[str]]=True
>                            , model:str='timegpt-1',
>                            num_partitions:Optional[int]=None)
> ```

Detect anomalies in your time series using TimeGPT.

|                          | **Type**             | **Default** | **Details**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|------|------------------|-------------------------|-------------------------|
| df                       | DataFrame            |             | The DataFrame on which the function will operate. Expected to contain at least the following columns:<br/>- time_col:<br/> Column name in `df` that contains the time indices of the time series. This is typically a datetime<br/> column with regular intervals, e.g., hourly, daily, monthly data points.<br/>- target_col:<br/> Column name in `df` that contains the target variable of the time series, i.e., the variable we <br/> wish to predict or analyze.<br/>Additionally, you can pass multiple time series (stacked in the dataframe) considering an additional column:<br/>- id_col:<br/> Column name in `df` that identifies unique time series. Each unique value in this column<br/> corresponds to a unique time series. |
| freq                     | Optional             | None        | Frequency of the data. By default, the freq will be inferred automatically.<br/>See [pandas’ available frequencies](https://pandas.pydata.org/pandas-docs/stable/user_guide/timeseries.html#offset-aliases).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| id_col                   | str                  | unique_id   | Column that identifies each serie.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| time_col                 | str                  | ds          | Column that identifies each timestep, its values can be timestamps or integers.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| target_col               | str                  | y           | Column that contains the target.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| level                    | Union                | 99          | Confidence level between 0 and 100 for detecting the anomalies.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| clean_ex_first           | bool                 | True        | Clean exogenous signal before making forecasts<br/>using TimeGPT.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| validate_token           | bool                 | False       | If True, validates token before <br/>sending requests.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| date_features            | Union                | False       | Features computed from the dates. <br/>Can be pandas date attributes or functions that will take the dates as input.<br/>If True automatically adds most used date features for the <br/>frequency of `df`.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| date_features_to_one_hot | Union                | True        | Apply one-hot encoding to these date features.<br/>If `date_features=True`, then all date features are<br/>one-hot encoded by default.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| model                    | str                  | timegpt-1   | Model to use as a string. Options are: `timegpt-1`, and `timegpt-1-long-horizon`. <br/>We recommend using `timegpt-1-long-horizon` for forecasting <br/>if you want to predict more than one seasonal <br/>period given the frequency of your data.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| num_partitions           | Optional             | None        | Number of partitions to use.<br/>If None, the number of partitions will be equal<br/>to the available parallel resources in distributed environments.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| **Returns**              | **pandas.DataFrame** |             | **DataFrame with anomalies flagged with 1 detected by TimeGPT.**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |

